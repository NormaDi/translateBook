# 4.1.2 Базовый файл URDF / Xacro.

Давайте теперь посмотрим на файл URDF/Xacro, который использовался выше для загрузки блочной модели базы робота. Файл называется _base.urdf.xacro_ и находится в каталоге _rbx2\_description/urdf/box\_robot_. Мы рассмотрим файл в разделах начиная сверху:

![](../.gitbook/assets/image%20%2871%29.jpeg)

Все файлы URDF / Xacro начинаются с этих двух открывающих тегов. Все после тега  будет определять наш компонент, и мы закроем весь файл с завершающим тегом _&lt;/ robot&gt;_.

![](../.gitbook/assets/image%20%2873%29.jpeg)

Раздел свойств позволяет нам назначать все измерения и смещения переменным, которые затем могут использоваться в остальной части файла. Если изменения будут внесены в робота позднее, просто измените эти значения соответствующим образом. При установке значений свойств учитывайте следующие моменты:

·      линейные размеры указаны в метрах

·      угловые значения приведены в радианах

·      при указании параметров _xyz_ оси координат выровнены по x, указывая направление робота вперед, yуказывает влево, а z указывает вверх. Например, свойство _wheel\_offset\_y_ выше указывает расстояние, на которое каждое колесо установлено слева или справа от центральной линии робота.

·      при назначении параметров вращения _rpy_ \(roll, pitch, yaw\) параметр roll \(r\) вращается вокруг оси x, шаг \(p\) - вокруг оси y, а yaw \(y\) вращается вокруг оси z.

Чтобы увидеть оси, прикрепленные к базе в RViz, установите значение **Alpha** для _base\_link_ примерно на _0,5_, например:

![page119image53159264](blob:https://app.gitbook.com/4e18bed6-c57b-4180-ac4e-1b960479868b)

Здесь мы установили значение **Alpha** равным 0,5 для _base\_link_ и отметили поле рядом с **Show Axes**. _RViz_ всегда использует один и тот же код цвета для осей кадра, прикрепленных к ссылке: красный для оси x, зеленый для y и синий для z.

Теперь вернемся к нашему обсуждению файла _base.urdf.xacro_. Вот блок для колеса:

![](../.gitbook/assets/image%20%2817%29.jpeg)

Колесо определяется как макрос, так что мы можем использовать его для каждого колеса без повторения _XML_. Мы не будем подробно описывать синтаксис, так как он уже описан URDF tutorials. Однако обратите внимание на использование параметра _reflect,_ который принимает значения _1_ или _-1_ для левой и правой сторон соответственно и позволяет нам переворачивать колесо и знак смещения y.

![](../.gitbook/assets/image%20%28103%29.jpeg)

Далее мы определим макрос для самой базы. В этом случае мы используем простую прямоугольную геометрию для компонента , включающую параметры, определенные в верхней части файла. Для блока  мы определили более широкую рамку для колес. Это обеспечивает запас прочности вокруг робота, чтобы предотвратить попадание колес на препятствия. \(Примечание: если колеса вашего робота лежат внутри периметра основания, вы можете просто использовать тот же блок, что и для визуального компонента.\)

![](../.gitbook/assets/image%20%286%29.png)

Здесь мы определяем ссылку _base\_footprint_ и фиксированное соединение, которое определяет ее отношение к _base\_link_. Как объяснено в следующем разделе, роль base\_footprint по существу состоит в определении высоты основания над землей. Как вы можете видеть выше, соединение между опорой и основанием поднимает основание на величину, рассчитанную по высоте основания и смещению по оси z колес. Чтобы понять, почему мы должны поднять робота на величину _base\_size\_z / 2,_ измените **Fixed Frame** в _RViz_ на _/base\_link_. Если вы используете мышь, чтобы сместить точку обзора так, чтобы вы смотрели на землю почти с ребра, изображение должно выглядеть так:

![page121image53468480](blob:https://app.gitbook.com/d2b91af6-f6b2-417f-9b5c-4b28bf40397e)

Обратите внимание, как источник компонента URDF-блока расположен в центре блока; то есть на высоте _base\_size\_z / 2_ метра над дном робота. Следовательно, фиксированное соединение между рамкой _/base\_footprint_ \(которая опирается на землю\) и рамкой _/base\_link_ должно включать перемещение в направлении z на расстояние _base\_size\_z/2_ метра, чтобы поднять дно робота. Наконец, давайте добавим два ведущих колеса к роботу:

![](../.gitbook/assets/image%20%2855%29.png)

Здесь мы дважды вызываем макрос  с параметром _reflect_, установленным сначала _1_ для левого колеса и _-1_ для правого, чтобы убедиться, что колеса установлены на противоположных сторонах основания. Параметр суффикса заставляет макрос  давать каждой ссылке на колесо уникальное имя.



